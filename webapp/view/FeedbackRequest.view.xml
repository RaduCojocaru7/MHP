<mvc:View
  controllerName="fbtool.controller.FeedbackRequest"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns="sap.m"
  xmlns:core="sap.ui.core"
  displayBlock="true">

  <Page title="Feedback Request">
    <headerContent>
      <Button
        icon="sap-icon://nav-back"
        text="Back"
        press="onNavBack"
        type="Transparent"
        class="subtleBtn"/>
    </headerContent>

    <content>
      <VBox class="sapUiMediumMargin">
        <VBox class="feedbackCard">

          <!-- Team member selection -->
          <Label text="Team member"/>
          <ComboBox
            id="teamMemberCombo"
            width="100%"
            placeholder="Choose team member"
            showClearIcon="true"
            change=".onTeamMemberChange"
            items="{
              path: 'mainService>/UserSet',
              parameters: { $select: 'USER_ID,NAME,TEAM_MNGR' }
            }">
            <core:Item key="{mainService>USER_ID}" text="{mainService>NAME}" />
          </ComboBox>

          <!-- Project dropdown (populate din User_ProjectsSet filtrat după user) -->
          <Label text="Project" class="sapUiTinyMarginTop"/>
          <ComboBox
            id="projectSelect"
            width="100%"
            placeholder="Choose project"
            showClearIcon="true"
            change=".onProjectSelectionChange"
            items="{
              path: 'mainService>/User_ProjectsSet',
              parameters: { $select: 'USER_ID,PROJ_ID,PROJ_NAME' }
            }">
            <core:Item key="{mainService>PROJ_ID}" text="{mainService>PROJ_NAME}" />
          </ComboBox>

          <!-- Manager name (set automat după proiectul selectat) -->
          <Label text="Project Manager" class="sapUiTinyMarginTop"/>
          <Input
            id="managerInput"
            value="{fr>/pmName}"
            editable="false"
            width="100%" />

          <!-- Feedback text area -->
          <Label text="Message" class="sapUiTinyMarginTop"/>
          <TextArea
            id="feedbackMessage"
            rows="5"
            width="100%" />

          <!-- Submit button -->
          <Button
            text="Request Feedback"
            press="onSubmitFeedback"
            class="sapUiTinyMarginTop feedbackButton"
            type="Emphasized" />

        </VBox>
      </VBox>
    </content>
  </Page>
</mvc:View>
